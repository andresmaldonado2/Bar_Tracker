import java.util.Arrays;
import java.util.Scanner;

public class CurveFitJNI
{
    static {
        //System.out.println(System.getProperty("java.library.path"));
        System.loadLibrary("Native");
    }
    /*
    private native double[] vectorProjection(double[] positionData, int size, int degree);
    //private native double[] rateOfForceDevelopment();
    
    private native double[][] performanceMetrics(double[] positionData, int size, int weight, boolean inKG);
    private native double maximumVelocity(double[] positionData, int size);
    private native double averageVelocity(double[] positionData, int size);
    private native double averageForceProduction();
    */
    private native double[] performanceMetrics(double[] positionData, int lastExtremaIndex, int size, int degree, int weight, double intialVelocity, boolean inKG);
    public static void main(String[] args)
    {
        Scanner sc = new Scanner(System.in);
        System.out.println("Enter anything to begin");
        String dummyString = sc.nextLine();
        double[][] positionData = new double[][]{
                {0.0,1.0},
                {2.0,0.0},
                {3.0,3.0},
                {4.0,5.0},
                {5.0,4.0}
        };
        double[] newPositionData = new double[] {30.0, 53.13010235415599, 30.968370961353457, 54.46232220802562, 31.952464693666432, 55.71312302279103, 32.95087252259036, 56.88865803962797, 33.96233207540377, 57.99461679191651, 34.9857113690718, 59.03624346792648, 36.019994447528724, 60.01836063115068, 37.0642685075532, 60.94539590092285, 38.11771241824462, 61.82140989004082, 39.17958652155482, 62.65012421993012, 39.17958652155482, 62.65012421993012, 38.11771241824462, 61.82140989004082, 37.0642685075532, 60.94539590092285, 36.019994447528724, 60.01836063115068, 34.9857113690718, 59.03624346792648, 33.96233207540377, 57.99461679191651, 32.95087252259036, 56.88865803962797, 31.952464693666432, 55.71312302279103, 30.968370961353457, 54.46232220802562, 30.0, 53.13010235415599, 30.0, 53.13010235415599, 30.964699871436896, 54.45747003946307, 31.945009962659952, 55.704006195645775, 32.93953658081484, 56.87579753620811, 33.947030268660455, 57.97847388211744, 34.966370175097886, 59.017226123718046, 35.99654994080288, 59.996829449962576, 37.03666504043759, 60.92166950026138, 38.08590148929843, 61.79576977040295, 39.14352580498633, 62.62281911495171, 40.20887610835242, 63.40619856855082, 39.14352580498633, 62.62281911495171, 38.08590148929843, 61.79576977040295, 37.03666504043759, 60.92166950026138, 35.99654994080288, 59.996829449962576, 34.966370175097886, 59.017226123718046, 33.947030268660455, 57.97847388211744, 32.93953658081484, 56.87579753620811, 31.945009962659952, 55.704006195645775, 30.964699871436896, 54.45747003946307, 30.0, 53.13010235415599, 30.0, 53.13010235415599, 30.94515390662817, 54.431611329454675, 31.9053248189052, 55.655384487462, 32.87919713868983, 56.80716199974456, 33.865588852991316, 57.89226220393491, 34.8634373437977, 58.9155975477683, 35.87178654151483, 59.881695336594696, 36.889775373741976, 60.7947212048552, 37.916627431251236, 61.658503819028226, 38.951641757254926, 62.47655976624697, 39.99418465978243, 63.25211791751504, 38.951641757254926, 62.47655976624697, 37.916627431251236, 61.658503819028226, 36.889775373741976, 60.7947212048552, 35.87178654151483, 59.881695336594696, 34.8634373437977, 58.9155975477683, 33.865588852991316, 57.89226220393491, 32.87919713868983, 56.80716199974456, 31.9053248189052, 55.655384487462, 30.94515390662817, 54.431611329454675, 30.0, 53.13010235415599, 30.0, 53.13010235415599, 30.94456925659817, 54.43083722367203, 31.9041379320259, 55.65392803199007, 32.87739272095643, 56.80510478285227, 33.863153593591896, 57.88967666334552, 34.86035964690159, 58.91254793050283, 35.8680562945971, 59.87823858794567, 36.88538374785303, 60.79090778060582, 37.91156670903097, 61.6543784200713, 38.94590518492493, 62.472161997984045, 39.98776631978776, 63.247482878352784, 38.94590518492493, 62.472161997984045, 37.91156670903097, 61.6543784200713, 36.88538374785303, 60.79090778060582, 35.8680562945971, 59.87823858794567, 34.86035964690159, 58.91254793050283, 33.863153593591896, 57.88967666334552, 32.87739272095643, 56.80510478285227, 31.9041379320259, 55.65392803199007, 30.94456925659817, 54.43083722367203, 30.0, 53.13010235415599, 30.0, 53.13010235415599, 30.7931935335066, 54.22916392370441, 31.597146454162804, 55.272664730248714, 32.411058115425064, 56.26407171350894, 33.23419685111913, 57.20663944171928, 34.06589380272063, 58.1034157587503, 34.90553722376109, 58.957249541895244, 35.752567253867646, 59.770799841262324, 36.606471144691284, 60.54654584318436, 37.466778913508556, 61.286797237625294, 38.333059396585746, 61.993704678637194, 39.20491667268839, 62.66927011248124, 40.081986826809576, 63.31535681446256, 37.466778913508556, 61.286797237625294, 36.606471144691284, 60.54654584318436, 35.752567253867646, 59.770799841262324, 34.90553722376109, 58.957249541895244, 34.06589380272063, 58.1034157587503, 33.23419685111913, 57.20663944171928, 32.411058115425064, 56.26407171350894, 31.597146454162804, 55.272664730248714, 30.7931935335066, 54.22916392370441, 30.0, 53.13010235415599, 30.0, 53.13010235415599, 30.560119983319673, 53.91371551833501, 31.125749899916592, 54.66898544574574, 31.69659477470395, 55.397173842259285, 32.272377876967646, 56.099488602124396, 32.85283956369922, 56.777084453585054, 33.43773618241671, 57.43106396744679, 34.02683903412138, 58.06247884519466, 34.61993339602898, 58.672331416920905, 35.21681760294828, 59.2615762911421, 35.817302185613336, 59.83112210874936, 36.42120906386998, 60.381833362016614, 37.02837079234079, 60.91453224696433, 37.63862985601889, 61.43000052360213, 38.251838013147626, 61.928981363806955, 38.86785568271221, 62.4121811709654, 39.486551373886414, 62.8802713591486, 40.1078011548298, 63.33389008259771, 35.21681760294828, 59.2615762911421, 34.61993339602898, 58.672331416920905, 34.02683903412138, 58.06247884519466, 33.43773618241671, 57.43106396744679, 32.85283956369922, 56.777084453585054, 32.272377876967646, 56.099488602124396, 31.69659477470395, 55.397173842259285, 31.125749899916592, 54.66898544574574, 30.560119983319673, 53.91371551833501, 30.0, 53.13010235415599, 30.0, 53.13010235415599, 30.46898617559905, 53.78871101481471, 30.941875946994546, 54.4272706731035, 31.418493051880468, 55.04653148202856, 31.898670413740295, 55.64721699134327, 32.38224965408221, 56.23002434503068, 32.869080625044745, 56.79562461997737, 33.35902096275584, 57.34466327919241, 33.851935661539116, 57.8777607165515, 34.347696668829066, 58.39551287327398, 34.84618250047352, 58.89849190919967, 35.34727787595856, 59.387246914450685, 35.85087337298299, 59.86230464927182, 36.3568651007289, 60.32417030177309, 36.86515439111906, 60.77332825497581, 37.375647507314156, 61.21024285601816, 37.888255368682, 61.635359181633454, 38.40289329146216, 62.049103795094155, 38.919480744350984, 62.45188549074297, 39.4379411182416, 62.84409602302409, 39.958201509369566, 63.226110817601985, 34.347696668829066, 58.39551287327398, 33.851935661539116, 57.8777607165515, 33.35902096275584, 57.34466327919241, 32.869080625044745, 56.79562461997737, 32.38224965408221, 56.23002434503068, 31.898670413740295, 55.64721699134327, 31.418493051880468, 55.04653148202856, 30.941875946994546, 54.4272706731035, 30.46898617559905, 53.78871101481471, 30.0, 53.13010235415599, 30.0, 53.13010235415599, 30.27098810700793, 53.51382852220459, 30.543309849619405, 53.890728801306636, 30.8169298728106, 54.26095195538792, 31.09181390048226, 54.62464375519406, 31.367928702407877, 54.981946979620915, 31.645242061913393, 55.33300142381398, 31.92372274430831, 55.67794391332529, 32.20334046608317, 56.01690832367079, 32.48406586488363, 56.35002560468316, 32.765870470267586, 56.67742380910277, 33.04872667524779, 56.99922812489579, 33.33260770861985, 57.31556091082978, 33.617487608072054, 57.6265417348777, 33.90334119407171, 57.93228741505771, 34.19014404452002, 58.23291206235011, 34.47787247016617, 58.52852712536578, 34.76650349076944, 58.81924143646837, 35.05601481199698, 59.105161259081726, 35.346384803043804, 59.38639033593789, 35.637592474960584, 59.66302993804488, 35.929617459674056, 59.9351789141755, 36.222439989684425, 60.20293374069741, 36.51604087842342, 60.46638857158378, 36.81040150125665, 60.72563528845976, 37.105503777113334, 60.980763550556595, 37.40133015072663, 61.23186084445804, 37.69786357546751, 61.47901253353753, 37.995087496755346, 61.7223019069963, 38.29298583602818, 61.96181022842304, 38.59154297525615, 62.19761678380578, 38.890743741981275, 62.42979892893598, 39.1905733948675, 62.65843213615235, 39.49101760974467, 62.88359004038005, 39.792062466130815, 63.10534448442672, 40.09369443421717, 63.323765563504416, 32.48406586488363, 56.35002560468316, 32.20334046608317, 56.01690832367079, 31.92372274430831, 55.67794391332529, 31.645242061913393, 55.33300142381398, 31.367928702407877, 54.981946979620915, 31.09181390048226, 54.62464375519406, 30.8169298728106, 54.26095195538792, 30.543309849619405, 53.890728801306636, 30.27098810700793, 53.51382852220459};
        int degree = 3;
        int weight = 450;
        boolean inKG = false;
        /*
        long startTime = System.nanoTime();
        //double[] data = new CurveFitJNI().performanceMetrics(newPositionData, 0, 1, degree, weight, 0.0, inKG);
        long endTime = System.nanoTime();
        System.out.println("Unoptimized Execution Time: " + ((endTime - startTime)/1000) + "microseconds");
        System.out.println("BEGIN PROJECTION RESULTS:\n");
        */
        double intialVelocity = 0.0;
        double avgForce = 0.0;
        double currentForce = 0.0;
        double avgVelocity = 0.0;
        double currentVelocity = 0.0;
        double[] results = new double[] {0.0, 0.0, 0.0};
        //int[] inputData = new int[] {0, newPositionData.length/2, degree, weight, intialVelocity, inKG, isConcentric};
        for(int i = 1; i < newPositionData.length/2; i += 1)
        {
            results = new CurveFitJNI().performanceMetrics(newPositionData, (int)results[2], i, degree, weight, results[1], inKG);
            avgForce += results[0];
            avgVelocity += results[1];
            currentForce = avgForce / (newPositionData.length/2);
            currentVelocity = avgVelocity / (newPositionData.length/2);
            System.out.println("CurrentForce: " + currentForce);
            System.out.println("CurrentVelocity: " + currentVelocity);
            //System.out.println(Arrays.toString(results));
        }
        avgForce = avgForce / (newPositionData.length/2);
        avgVelocity = avgVelocity / (newPositionData.length/2);
        System.out.println("AvgForce: " + avgForce);
        System.out.println("AvgVelocity: " + avgVelocity);
    }
}
